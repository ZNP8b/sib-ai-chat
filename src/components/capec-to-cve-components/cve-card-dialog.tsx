import { Button, CloseButton, Dialog, Portal, Text } from '@chakra-ui/react'
import { Vulnerability } from '@/components/capec-to-cve-components/types.tsx'

export function CveCardDialog({ cve }: Vulnerability) {
  return (
    <Dialog.Root placement='center' motionPreset='slide-in-bottom'>
      <Dialog.Trigger asChild>
        <Button variant='outline'>Подробнее</Button>
      </Dialog.Trigger>
      <Portal>
        <Dialog.Backdrop />
        <Dialog.Positioner>
          <Dialog.Content>
            <Dialog.Header>
              <Dialog.Title>{cve.id}</Dialog.Title>
            </Dialog.Header>
            <Dialog.Body>
              <Text>Описание:</Text>
              {cve.descriptions[0].value}
              <br />
              <br />
              <Text>
                Опубликован:{' '}
                {new Date(cve.published).toLocaleDateString('ru-RU')}
              </Text>

              <Text>Статус: {cve.vulnStatus}</Text>

              {cve.metrics?.cvssMetricV31?.map(metric => {
                return (
                  <div key={metric.source + metric.cvssData}>
                    <Text>Источник: {metric.source}</Text>
                    <Text>Тип: {metric.type}</Text>
                    <Text>Версия: {metric.cvssData.version}</Text>
                    <Text>Вектор атаки: {metric.cvssData.vectorString}</Text>
                    <Text>Базовый балл: {metric.cvssData.baseScore}</Text>
                    <Text>
                      Базовая серьезность: {metric.cvssData.baseSeverity}
                    </Text>
                    <Text>Вектор атаки: {metric.cvssData.attackVector}</Text>
                    <Text>
                      Сложность атаки: {metric.cvssData.attackComplexity}
                    </Text>
                    <Text>
                      Требуемые привилегии: {metric.cvssData.privilegesRequired}
                    </Text>
                    <Text>
                      Взаимодействие с пользователем:{' '}
                      {metric.cvssData.userInteraction}
                    </Text>
                    <Text>Область: {metric.cvssData.scope}</Text>
                    <Text>
                      Воздействие на конфиденциальность:{' '}
                      {metric.cvssData.confidentialityImpact}
                    </Text>
                    <Text>
                      Воздействие на целостность:{' '}
                      {metric.cvssData.integrityImpact}
                    </Text>
                    <Text>
                      Воздействие на доступность:{' '}
                      {metric.cvssData.availabilityImpact}
                    </Text>
                    <Text>Балл эксплуатации: {metric.exploitabilityScore}</Text>
                    <Text>Балл воздействия: {metric.impactScore}</Text>
                  </div>
                )
              })}
            </Dialog.Body>
            <Dialog.CloseTrigger asChild>
              <CloseButton colorPalette='purple' size='sm' />
            </Dialog.CloseTrigger>
          </Dialog.Content>
        </Dialog.Positioner>
      </Portal>
    </Dialog.Root>
  )
}
